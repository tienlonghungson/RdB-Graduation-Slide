\begin{frame}{Encoder}
    \begin{itemize}
        \item Based on lexicographic minimal de Bruijn sequence (granddaddy by Knuth):
        
        Example with order $5$: $0\ 00001\ 00011\ 00101\ 00111\ 01011\ 01111\ 1$
        
        $\rightarrow$ Cut the sequence at the "right place".
        \item Complexity = Complexity to generate granddaddy sequence.
        
        \hspace{1.8cm} = Constant amortized time per symbol~\sfcite{ruskey1992generating}.
        \item The correctness can be proved easily.
    \end{itemize}
    \pause
    Cut at $\bfu = 0^{s+1}1^{k-s-1}$.
    
    \pause
    Example $k=5,s=2:$

    \only<4>{$$0\ 00001\ 00011\ 00101\ 00111\ 01011\ 01111\ 1$$}
    
    \only<5>{$${\color{gray}0\ 00001\ 0} {\color{red}|}0011\ 00101\ 00111\ 01011\ 01111\ 1$$}
    
    \only<6->{$${\color{gray}0\ 00001\ 0} {\color{red}|}0011\ 00101\ 00111\ 01011\ 01111\ 1\ {\color{cyan}00}$$}    
\end{frame}

\begin{frame}{Encoder}
    \begin{algorithm}[H]
    \DontPrintSemicolon
        \SetKwInOut{KwIn}{Input}
        \SetKwInOut{KwOut}{Output}
        \KwIn{$k$, and descending ordered set \L$^{(n)}$. }
        \KwOut{ $(k,s)$-RLL dBs}
        \BlankLine
            % Find the set of Lyndon words  $S=\left\{\lambda_{i}:\ \lambda_{i}\in\mathsf{L}^{(k)}\right\}$
        
        $\mathbf{w}\gets$emptystring\;
        \For{$\lambda \in$\L$^{(n)}$}{
            $\mathbf{w}.prepend(\lambda)$\;
            \If{$\lambda== 0^{s+1}1^{k-s-1}$}{
                $\mathbf{w} = \mathbf{w}[2,\ell]0^{s}$\;
                \textbf{break}\;
            }
        }
        \KwRet{$\mathbf{w}$}
        \caption{Encode (k,s)-RdB}
        \label{alg:encoder}
    \end{algorithm}
    $\text{\L}^{(n)}$: generated by FKM algorithm~\sfcite{fredricksen1978necklaces,fredricksen1986algorithm}.
\end{frame}

\begin{frame}{The Optimality of The Encoder }
    \begin{itemize}
        \item We're proving that our encoder generate the longest $(k,s)$-RdB sequences.
    \end{itemize}
    \begin{example}[$k=5,s=2$]
    $${\color{gray}0\ 00001\ 0} {\color{red}|}\underbrace{0011\ 00101\ 00111\ 01011\ 01111\ 1 {\color{cyan}00}}_{\mathrm{this\ length}=N(k,s)\ ?} $$
    \visible<2->{
    Equivalent to:
        $${\color{gray}0\ 00001\ 0} {\color{red}|}\underbrace{0011\ 00101\ 00111\ 01011\ 01111\ 1}_{\text{How long is this sequence? (=X)}} {\color{cyan}00}$$
        We'll prove that $X=N(k,s)-s$
    }
    \end{example}
    
\end{frame}

\begin{frame}{The Optimality of The Encoder}
$\langle \bfv\rangle$ minimal rotation of $\bfv$ (exp: $\langle110\rangle=011,\ \langle1001\rangle=0011$).

$S(\bfv) = \left\{\bfx\in\Sigma^{\card{\bfv}:\langle\bfx\rangle<\bfv} \right\}$.

\L$^{(n)}$: set of Lyndon words whose length is a divisor of $n$.

\begin{lemma}[Lemma 29\sfcite{kociumaka2016efficient}]
    Let $\bfv$ be a Lyndon word. Define \L$(\bfv) = \{\lambda\in\text{\L}^k:\lambda^{\frac{k}{\card{\lambda}}}\leq\bfv\}$ to be the set of all Lyndon words smaller than $\bfv$ whose length is the divisor of $k$. Then: $\sum_{\lambda\in\text{\L}(\bfv)}\card{\lambda}=\card{S(\bfv)}$.
\end{lemma}

\[\lefteqn{\overbrace{\phantom{0\ 00001\ 0{\color{red}|}0011\ }}^{\mathrm{length}=\card{S(\bfu)}}}
0\ 00001\ \underbrace{0{\color{red}|}0011\ 00101\ 00111\ 01011\ 01111\ 1}_{\text{length needs calculating}}\]
\end{frame}

\begin{frame}{The Optimality of The Encoder}
    \begin{overprint}
        \onslide<1>
        \begin{align}
            \card{S(\bfu)} = 1 + \sum_{t=M}^{k}(k-t+1)\card{C(t-2,s)} + \sum_{t=1}^{k-s}(k-t+1)A_{t}
        \end{align}
        where $\card{C(k,s))} = 2^{k}-\card{W(k,s)}$, $A_{t}=2^{t-2}$, $M=\max(s+2,k-s+1)$
        \onslide<2->
        \centering For $s=1$, $\card{S(\bfu)}=2^{k}-\left(\card{W(k,1)}-\card{W(k-4,1}\right)$
    \end{overprint}
    \only<3-> {
        $k=5,s=1$
    }
    
    \only<3>{
        \[\overbrace{0\ 00001\ 00011\  00101\ 0{\color{red}|}0111\ }^{ 2^{k}-\left(\card{W(k,1)}-\card{W(k-4,1}\right) } 01011\ 01111\ 1\]
    }
    
    \only<4>{
        \[\lefteqn{\overbrace{\phantom{0\ 00001\ 00011\  00101\ 0{\color{red}|}0111\ }}^{ 2^{k}-\left(\card{W(k,1)}-\card{W(k-4,1}\right) } }
        0\ 00001\ 00011\  00101\ \underbrace{0{\color{red}|}0111\ 01011\ 01111\ 1}_{\card{W(k,1)}-\card{W(k-4,1)}+k}\]
    }
    
    \only<5>{
        \[\lefteqn{\overbrace{\phantom{0\ 00001\ 00011\  00101\ 0{\color{red}|}0111\ }}^{ 2^{k}-\left(\card{W(k,1)}-\card{W(k-4,1}\right) } }
        0\ 00001\ 00011\  00101\ \underbrace{\underbrace{0{\color{red}|}0111\ 01011\ 01111\ 1}_{\card{W(k,1)}-\card{W(k-4,1)}+k}}_{=N(k,1)}\]
    }
\end{frame}

\begin{frame}{Decoder}
    \begin{enumerate}
        \item Based on the decoder $\mathcal{D}_{KRR}$ proposed by \citeauthor{kociumaka2016efficient}\sfcite{kociumaka2016efficient}.
        \item Based on the observation:
        \begin{itemize}
            \item $i=\mathcal{D}_{KRR}(\bfu=0^{s+1}1^{k-s-1})$: position of $\bfu$ in granddaddy sequence $\bfx$ of order $k$.
            \item Location of $\bfv$ ($\card{\bfv}=k$) in encoded sequence = Location of $\bfv$ in $\bfx$ - $i$.
            
            \hspace{6.7cm}= $\mathcal{D}_{KRR}(\bfv)-i$.
        \end{itemize}
        \item Complexity = Complexity of $\mathcal{D}_{KRR}$.
    \end{enumerate}
    \begin{columns}
        \visible<2->{
        \begin{column}{.3\textwidth}
            Exp: $k=5,s=1$
            
            then $\bfu=00111$
            
            say: $\bfv=10111$
        \end{column}
        }
        \visible<3->{
        \begin{column}{.7\textwidth}
            \only<3>{
                $0\ 00001\ 00011\ 00101\ 00111\ 01011\ 01111\ 1\ {\color{cyan}0}$
            }
            \only<4>{
                $0\ 00001\ 00011\ 00101\ \underset{i}{\fcolorbox{red}{white}{00111}}\ 01011\ 01111\ 1\ {\color{cyan}0}$
            }
            
            \only<5->{
                $0\ 00001\ 00011\ 00101\ \underset{i}{\fcolorbox{red}{white}{00111}}\ 0101\underset{j}{\fcolorbox{red}{white}{1\ 0111}}1\ 1\ {\color{cyan}0}$
            }
            
            \only<6>{
            
                $\hspace{3.9cm}0111\ \ 0101\ 1\ 0111\ 1\ 1\ {\color{cyan}0}$
            }
            \only<7->{
                
                $\hspace{3.9cm}0111\ \ 0101\underset{j-i}{\fcolorbox{red}{white}{1\ 0111}}1\ 1\ {\color{cyan}0}$
            }
        \end{column}
        }
    \end{columns}        
\end{frame}

\begin{frame}{Decoder}
    Denote $c_{k,s}$ to be the encoded sequence.
    \begin{algorithm}[H]
    \DontPrintSemicolon
        \SetKwInOut{KwIn}{Input}
        \SetKwInOut{KwOut}{Output}
        \KwIn{A word $\bfv=(v_1,\ldots,v_k)$ of length $k$}
        \KwOut{a is the location of $\bfv$ in $\bf\bfc_{k,s}$}
        \BlankLine
        
        $i \gets \mathcal{D}_{KRR}(\bfu_{k,s})$; \\
         \If {$\bfv = 1^{j}0^{k-j}$,}{\KwRet{$n-i+1-(k-j)$};}
         \Else{\KwRet{$\mathcal{D}_{KRR}(\bfv)-i$};}
        \caption{Decode (k,s)-RdB $\bf\bfc_{k,s}$}
        \label{alg:decode}
    \end{algorithm}  
\end{frame}